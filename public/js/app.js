(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var _utilities = require('./utilities.js');

var SCREEN_WIDTH = window.innerWidth;
var SCREEN_HEIGHT = window.innerHeight;

var scene = new THREE.Scene();

var camera = new THREE.PerspectiveCamera(75, SCREEN_WIDTH / SCREEN_HEIGHT, 0.1, 1000);

var ambient = new THREE.AmbientLight(0x444444);
scene.add(ambient);

var renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);

renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFShadowMap;

document.body.appendChild(renderer.domElement);

// var geometry = new THREE.BoxGeometry( 1, 1, 2 );
// var material = new THREE.MeshBasicMaterial( { color: 0xBFBFBF } );
// var cube = new THREE.Mesh( geometry, material );
// scene.add( cube );

var charGeometry = new THREE.BoxGeometry(.6, .9, 0.2);
var charMaterial = new THREE.MeshPhongMaterial({ color: 0xC0C0C0 });
var chara = new THREE.Mesh(charGeometry, charMaterial);
scene.add(chara);

chara.castShadow = true;
// chara.receiveShadow = true;
var startingXPos = -2.5;

var charXPosition = {
  currentX: startingXPos,
  nextX: startingXPos
};
chara.position.set(charXPosition.currentX, -2.3, 0.2);

var jumpRange = {
  upperBound: 1000,
  lowerBound: 0,
  currentPos: 0,
  isJumping: false
};
var movement = {
  walking: false,
  keysUp: false,
  keysDown: false,
  keysLeft: false,
  keysRight: false
};

var groundGeometry = new THREE.BoxGeometry(12, 0.3, 1);
var groundMaterial = new THREE.MeshLambertMaterial({ color: 0xFFFFFF });
var ground = new THREE.Mesh(groundGeometry, groundMaterial);
ground.castShadow = false;
ground.receiveShadow = true;
scene.add(ground);
ground.position.set(0, -2.9, 0);

var SHADOW_MAP_WIDTH = 2048,
    SHADOW_MAP_HEIGHT = 1024;
var light = new THREE.SpotLight(0xFFFFFF, 1, 0, Math.PI / 2);
// var light = new THREE.SpotLight( 0xAAAAAA );
light.position.set(4, 2, 10);
light.target.position.set(chara.position);

light.castShadow = true;

light.shadow = new THREE.LightShadow(new THREE.PerspectiveCamera(50, 1, 0.1, 1000));
light.shadow.bias = 0.0001;
light.shadow.mapSize.width = SHADOW_MAP_WIDTH;
light.shadow.mapSize.height = SHADOW_MAP_HEIGHT;

scene.add(light);
renderer.setClearColor(0xEEEEEE, 1);

camera.position.z = 5;

var minY = -2.3,
    prevY = minY,
    maxFound = false,
    minFound = false,
    maxY = void 0;

var render = function render() {
  requestAnimationFrame(render);

  // cube.rotation.x += 0.02;
  // cube.rotation.y += 0.0225;
  // cube.rotation.z += 0.0175;

  var thaX = charXPosition.nextX;

  window.addEventListener("keydown", function (event) {
    if (event.keyCode === 39) {
      charXPosition.nextX += .1;
      movement.walking = true;
      movement.keysRight = true;
      // console.log(chara.position.x)
      if (chara.position.x >= 4.8) {
        charXPosition.nextX = 4.8;
      }
    } else if (event.keyCode === 37) {
      charXPosition.nextX += -.1;
      movement.walking = true;
      movement.keysLeft = true;
      // console.log(chara.position.x)
      if (chara.position.x <= -4.795999999999992) {
        charXPosition.nextX = -4.795999999999992;
      }
    } else if (event.keyCode === 38) {
      // console.log(chara.position.y )
      // chara.position.y = -0.4 + 1*Math.sin(dtime/1000);
      // console.log(chara.position.y)
      jumpRange.isJumping = true;
      movement.walking = true;
      movement.keysUp = true;
    }
  });

  window.addEventListener('keyup', function (e) {

    switch (e.keyCode) {
      case 39:
        movement.keysRight = false;
        break;
      case 37:
        movement.keysLeft = false;
        break;
      case 38:
        movement.keysUp = false;
        break;
      case 40:
        movement.keysDown = false;
        break;
      default:
        //no-op
        break;
    }

    if (!movement.keysDown && !movement.keysLeft && !movement.keysUp && !movement.keysRight) {
      movement.walking = false;
    }
  });

  if (jumpRange.isJumping) {

    jumpRange.currentPos++;

    var charaPositionYCalc = minY + 2.5 * Math.sin(jumpRange.currentPos / 10);

    if (typeof maxY !== 'number') maxY = charaPositionYCalc;else maxY = chara.position.y > maxY ? charaPositionYCalc : maxY;

    if (typeof minY !== 'number') minY = charaPositionYCalc;else minY = chara.position.y < minY ? charaPositionYCalc : minY;

    if (charaPositionYCalc > maxY && charaPositionYCalc > prevY || prevY === maxY) {
      maxY = Math.max(prevY, charaPositionYCalc);
      // console.log('oh myh god make it stop', maxY, prevY)
    }

    if (charaPositionYCalc <= minY) {
      chara.position.y = minY;
      jumpRange.isJumping = false;
      jumpRange.currentPos = 0;
    } else {
      chara.position.y = charaPositionYCalc;
    }

    prevY = chara.position.y;
  }

  if (!movement.walking) {
    charXPosition.nextX = chara.position.x;
  } else {
    if (chara.position.x < charXPosition.nextX) {
      chara.position.x += .1;
      if (chara.position.x >= 4.8) {
        chara.position.x = 4.8;
      }
    }

    if (chara.position.x > charXPosition.nextX) {
      chara.position.x -= .1;
      if (chara.position.x <= -4.8) {
        chara.position.x = -4.8;
      }
    }
  }

  renderer.render(scene, camera);
};

render();
var daResize = function daResize() {
  (0, _utilities.handleWindowResize)(camera, renderer);
};

window.addEventListener('resize', daResize);

},{"./utilities.js":2}],2:[function(require,module,exports){
"use strict";

// import {SCREEN_WIDTH,SCREEN_HEIGHT,camera,renderer} from './app.js'


var handleWindowResize = function handleWindowResize(cam, rendrr) {
  var camera_ = cam;
  var renderer_ = rendrr;

  var newWidth = window.innerWidth,
      newHeight = window.innerHeight;

  camera_.aspect = newWidth / newHeight;
  camera_.updateProjectionMatrix();
  renderer_.setSize(newWidth, newHeight);
};

module.exports = {
  handleWindowResize: handleWindowResize
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc2NyaXB0cy9hcHAuanMiLCJzcmMvc2NyaXB0cy91dGlsaXRpZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0NBOztBQUVBLElBQUksZUFBZSxPQUFuQixBQUEwQjtBQUMxQixJQUFJLGdCQUFnQixPQUFwQixBQUEyQjs7QUFFM0IsSUFBSSxRQUFRLElBQUksTUFBaEIsQUFBWSxBQUFVOztBQUV0QixJQUFJLFNBQVMsSUFBSSxNQUFKLEFBQVUsa0JBQVYsQUFBNkIsSUFBSSxlQUFqQyxBQUE4QyxlQUE5QyxBQUE2RCxLQUExRSxBQUFhLEFBQWtFOztBQUUvRSxJQUFJLFVBQVUsSUFBSSxNQUFKLEFBQVUsYUFBeEIsQUFBYyxBQUF3QjtBQUN0QyxNQUFBLEFBQU0sSUFBTixBQUFXOztBQUdYLElBQUksV0FBVyxJQUFJLE1BQW5CLEFBQWUsQUFBVTtBQUN6QixTQUFBLEFBQVMsUUFBUyxPQUFsQixBQUF5QixZQUFZLE9BQXJDLEFBQTRDOztBQUU1QyxTQUFBLEFBQVMsVUFBVCxBQUFtQixVQUFuQixBQUE2QjtBQUM3QixTQUFBLEFBQVMsVUFBVCxBQUFtQixPQUFPLE1BQTFCLEFBQWdDOztBQUVoQyxTQUFBLEFBQVMsS0FBVCxBQUFjLFlBQWEsU0FBM0IsQUFBb0M7O0FBSXBDO0FBQ0E7QUFDQTtBQUNBOztBQUVBLElBQUksZUFBZSxJQUFJLE1BQUosQUFBVSxZQUFWLEFBQXNCLElBQXRCLEFBQTBCLElBQTdDLEFBQW1CLEFBQThCO0FBQ2pELElBQUksZUFBZSxJQUFJLE1BQUosQUFBVSxrQkFBa0IsRUFBRSxPQUFqRCxBQUFtQixBQUE0QixBQUFTO0FBQ3hELElBQUksUUFBUSxJQUFJLE1BQUosQUFBVSxLQUFWLEFBQWUsY0FBM0IsQUFBWSxBQUE2QjtBQUN6QyxNQUFBLEFBQU0sSUFBTixBQUFVOztBQUVWLE1BQUEsQUFBTSxhQUFOLEFBQW1CO0FBQ25C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LE9BQU0sQUFDekM7WUFBQSxBQUFNLFNBQU4sQUFBZSxLQUFmLEFBQW9CLEFBQ3BCO1VBQUcsTUFBQSxBQUFNLFNBQU4sQUFBZSxLQUFLLENBQXZCLEFBQXdCLEtBQUksQUFDMUI7Y0FBQSxBQUFNLFNBQU4sQUFBZSxJQUFJLENBQW5CLEFBQW9CLEFBQ3JCO0FBQ0Y7QUFDRjtBQUlEOztXQUFBLEFBQVMsT0FBVCxBQUFnQixPQUFoQixBQUF1QixBQUN4QjtBQXJIRDs7QUF1SEE7QUFDQSxJQUFJLFdBQVcsU0FBWCxBQUFXLFdBQVUsQUFDdkI7cUNBQUEsQUFBbUIsUUFBbkIsQUFBMkIsQUFDNUI7QUFGRDs7QUFJQSxPQUFBLEFBQU8saUJBQVAsQUFBd0IsVUFBeEIsQUFBa0M7Ozs7O0FDdE9sQzs7O0FBR0EsSUFBSSxxQkFBcUIsU0FBckIsQUFBcUIsbUJBQUEsQUFBUyxLQUFULEFBQWMsUUFBTyxBQUM1QztNQUFJLFVBQUosQUFBYyxBQUNkO01BQUksWUFBSixBQUFnQixBQUVoQjs7TUFBSSxXQUFXLE9BQWYsQUFBc0I7TUFDbEIsWUFBWSxPQURoQixBQUN1QixBQUV2Qjs7VUFBQSxBQUFRLFNBQVMsV0FBakIsQUFBNEIsQUFDNUI7VUFBQSxBQUFRLEFBQ1I7WUFBQSxBQUFVLFFBQVYsQUFBbUIsVUFBbkIsQUFBNkIsQUFHOUI7QUFaRDs7QUFlQSxPQUFBLEFBQU87c0JBQVAsQUFBaUI7QUFBQSxBQUNmIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlxuaW1wb3J0IHtoYW5kbGVXaW5kb3dSZXNpemV9IGZyb20gJy4vdXRpbGl0aWVzLmpzJ1xuXG52YXIgU0NSRUVOX1dJRFRIID0gd2luZG93LmlubmVyV2lkdGg7XG52YXIgU0NSRUVOX0hFSUdIVCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblxudmFyIHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cbnZhciBjYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoIDc1LCBTQ1JFRU5fV0lEVEgvU0NSRUVOX0hFSUdIVCwgMC4xLCAxMDAwICk7XG5cbnZhciBhbWJpZW50ID0gbmV3IFRIUkVFLkFtYmllbnRMaWdodCggMHg0NDQ0NDQgKTtcbnNjZW5lLmFkZCggYW1iaWVudCApO1xuXG5cbnZhciByZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKCk7XG5yZW5kZXJlci5zZXRTaXplKCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0ICk7XG5cbnJlbmRlcmVyLnNoYWRvd01hcC5lbmFibGVkID0gdHJ1ZTtcbnJlbmRlcmVyLnNoYWRvd01hcC50eXBlID0gVEhSRUUuUENGU2hhZG93TWFwO1xuXG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCByZW5kZXJlci5kb21FbGVtZW50ICk7XG5cblxuXG4vLyB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoIDEsIDEsIDIgKTtcbi8vIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCggeyBjb2xvcjogMHhCRkJGQkYgfSApO1xuLy8gdmFyIGN1YmUgPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdGVyaWFsICk7XG4vLyBzY2VuZS5hZGQoIGN1YmUgKTtcblxudmFyIGNoYXJHZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSguNiwgLjksIDAuMik7XG52YXIgY2hhck1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHsgY29sb3I6IDB4QzBDMEMwIH0pXG52YXIgY2hhcmEgPSBuZXcgVEhSRUUuTWVzaChjaGFyR2VvbWV0cnksIGNoYXJNYXRlcmlhbCk7XG5zY2VuZS5hZGQoY2hhcmEpO1xuXG5jaGFyYS5jYXN0U2hhZG93ID0gdHJ1ZTtcbi8vIGNoYXJhLnJlY2VpdmVTaGFkb3cgPSB0cnVlO1xudmFyIHN0YXJ0aW5nWFBvcyA9IC0yLjVcblxudmFyIGNoYXJYUG9zaXRpb24gPSB7XG4gIGN1cnJlbnRYIDogc3RhcnRpbmdYUG9zLFxuICBuZXh0WDpzdGFydGluZ1hQb3Ncbn1cbmNoYXJhLnBvc2l0aW9uLnNldChjaGFyWFBvc2l0aW9uLmN1cnJlbnRYLCAtMi4zLCAwLjIpO1xuXG52YXIganVtcFJhbmdlID0ge1xuICB1cHBlckJvdW5kOiAxMDAwLFxuICBsb3dlckJvdW5kOiAwLFxuICBjdXJyZW50UG9zOiAwLFxuICBpc0p1bXBpbmc6IGZhbHNlXG59XG52YXIgbW92ZW1lbnQgPSB7XG4gIHdhbGtpbmc6IGZhbHNlLFxuICBrZXlzVXA6IGZhbHNlLFxuICBrZXlzRG93bjogZmFsc2UsXG4gIGtleXNMZWZ0OiBmYWxzZSxcbiAga2V5c1JpZ2h0OiBmYWxzZVxufVxuXG52YXIgZ3JvdW5kR2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMTIsMC4zLDEpO1xudmFyIGdyb3VuZE1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwoIHsgY29sb3I6IDB4RkZGRkZGIH0gKTtcbnZhciBncm91bmQgPSBuZXcgVEhSRUUuTWVzaCggZ3JvdW5kR2VvbWV0cnksIGdyb3VuZE1hdGVyaWFsICk7XG5ncm91bmQuY2FzdFNoYWRvdyA9IGZhbHNlO1xuZ3JvdW5kLnJlY2VpdmVTaGFkb3cgPSB0cnVlO1xuc2NlbmUuYWRkKCBncm91bmQgKTtcbmdyb3VuZC5wb3NpdGlvbi5zZXQoMCwgLTIuOSwgMCk7XG5cbnZhciBTSEFET1dfTUFQX1dJRFRIID0gMjA0OCwgU0hBRE9XX01BUF9IRUlHSFQgPSAxMDI0O1xudmFyIGxpZ2h0ID0gbmV3IFRIUkVFLlNwb3RMaWdodCggMHhGRkZGRkYsIDEsIDAsIE1hdGguUEkgLyAyICk7XG4vLyB2YXIgbGlnaHQgPSBuZXcgVEhSRUUuU3BvdExpZ2h0KCAweEFBQUFBQSApO1xubGlnaHQucG9zaXRpb24uc2V0KCA0LCAyLCAxMCApO1xubGlnaHQudGFyZ2V0LnBvc2l0aW9uLnNldCggY2hhcmEucG9zaXRpb24gKTtcblxubGlnaHQuY2FzdFNoYWRvdyA9IHRydWU7XG5cbmxpZ2h0LnNoYWRvdyA9IG5ldyBUSFJFRS5MaWdodFNoYWRvdyggbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA1MCwgMSwgMC4xLCAxMDAwICkgKTtcbmxpZ2h0LnNoYWRvdy5iaWFzID0gMC4wMDAxO1xubGlnaHQuc2hhZG93Lm1hcFNpemUud2lkdGggPSBTSEFET1dfTUFQX1dJRFRIO1xubGlnaHQuc2hhZG93Lm1hcFNpemUuaGVpZ2h0ID0gU0hBRE9XX01BUF9IRUlHSFQ7XG5cbnNjZW5lLmFkZCggbGlnaHQgKTtcbnJlbmRlcmVyLnNldENsZWFyQ29sb3IoIDB4RUVFRUVFLCAxKTtcblxuY2FtZXJhLnBvc2l0aW9uLnogPSA1O1xuXG5sZXQgbWluWSA9IC0yLjMsXG4gICAgcHJldlkgPSBtaW5ZLFxuICAgIG1heEZvdW5kID0gZmFsc2UsXG4gICAgbWluRm91bmQgPSBmYWxzZSxcbiAgICBtYXhZXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCByZW5kZXIgKTtcblxuICAvLyBjdWJlLnJvdGF0aW9uLnggKz0gMC4wMjtcblx0Ly8gY3ViZS5yb3RhdGlvbi55ICs9IDAuMDIyNTtcblx0Ly8gY3ViZS5yb3RhdGlvbi56ICs9IDAuMDE3NTtcblxuICBsZXQgdGhhWCA9IGNoYXJYUG9zaXRpb24ubmV4dFhcblxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihldmVudCl7XG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDM5KXtcbiAgICAgICAgY2hhclhQb3NpdGlvbi5uZXh0WCArPSAuMVxuICAgICAgICBtb3ZlbWVudC53YWxraW5nID0gdHJ1ZVxuICAgICAgICBtb3ZlbWVudC5rZXlzUmlnaHQgPSB0cnVlXG4gICAgICAvLyBjb25zb2xlLmxvZyhjaGFyYS5wb3NpdGlvbi54KVxuICAgICAgaWYoY2hhcmEucG9zaXRpb24ueCA+PSA0Ljgpe1xuICAgICAgICBjaGFyWFBvc2l0aW9uLm5leHRYID0gNC44XG4gICAgICB9XG4gICAgfWVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT09IDM3KXtcbiAgICAgIGNoYXJYUG9zaXRpb24ubmV4dFggKz0gLS4xXG4gICAgICBtb3ZlbWVudC53YWxraW5nID0gdHJ1ZVxuICAgICAgbW92ZW1lbnQua2V5c0xlZnQgPSB0cnVlXG4gICAgICAvLyBjb25zb2xlLmxvZyhjaGFyYS5wb3NpdGlvbi54KVxuICAgICAgaWYoY2hhcmEucG9zaXRpb24ueCA8PSAtNC43OTU5OTk5OTk5OTk5OTIpe1xuICAgICAgICBjaGFyWFBvc2l0aW9uLm5leHRYPSAtNC43OTU5OTk5OTk5OTk5OTI7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAzOCl7XG4gICAgICAvLyBjb25zb2xlLmxvZyhjaGFyYS5wb3NpdGlvbi55IClcbiAgICAgIC8vIGNoYXJhLnBvc2l0aW9uLnkgPSAtMC40ICsgMSpNYXRoLnNpbihkdGltZS8xMDAwKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGNoYXJhLnBvc2l0aW9uLnkpXG4gICAgICBqdW1wUmFuZ2UuaXNKdW1waW5nID0gdHJ1ZVxuICAgICAgbW92ZW1lbnQud2Fsa2luZyA9IHRydWVcbiAgICAgIG1vdmVtZW50LmtleXNVcCA9IHRydWVcbiAgICB9XG59KVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKXtcblxuICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgIGNhc2UgMzk6XG4gICAgICBtb3ZlbWVudC5rZXlzUmlnaHQgPSBmYWxzZVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSAzNzpcbiAgICAgIG1vdmVtZW50LmtleXNMZWZ0ID0gZmFsc2VcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMzg6XG4gICAgICBtb3ZlbWVudC5rZXlzVXAgPSBmYWxzZVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSA0MDpcbiAgICAgIG1vdmVtZW50LmtleXNEb3duID0gZmFsc2VcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICAvL25vLW9wXG4gICAgICBicmVhaztcbiAgfVxuXG5cbiAgaWYoIW1vdmVtZW50LmtleXNEb3duICYmICFtb3ZlbWVudC5rZXlzTGVmdCAmJlxuICAgICAhbW92ZW1lbnQua2V5c1VwICYmICFtb3ZlbWVudC5rZXlzUmlnaHQpe1xuICAgIG1vdmVtZW50LndhbGtpbmcgPSBmYWxzZVxuICB9XG5cbn0pXG5cblx0aWYoanVtcFJhbmdlLmlzSnVtcGluZyl7XG5cbiAgICBqdW1wUmFuZ2UuY3VycmVudFBvcysrXG5cbiAgICBsZXQgY2hhcmFQb3NpdGlvbllDYWxjID0gbWluWSArIDIuNSpNYXRoLnNpbihqdW1wUmFuZ2UuY3VycmVudFBvcy8xMClcblxuXG4gICAgaWYodHlwZW9mIG1heFkgIT09ICdudW1iZXInKSBtYXhZID0gY2hhcmFQb3NpdGlvbllDYWxjXG4gICAgICBlbHNlIG1heFkgPSBjaGFyYS5wb3NpdGlvbi55ID4gbWF4WSA/IGNoYXJhUG9zaXRpb25ZQ2FsYyA6IG1heFlcblxuICAgIGlmKHR5cGVvZiBtaW5ZICE9PSAnbnVtYmVyJykgbWluWSA9IGNoYXJhUG9zaXRpb25ZQ2FsY1xuICAgICAgZWxzZSBtaW5ZID0gY2hhcmEucG9zaXRpb24ueSA8IG1pblkgPyAgY2hhcmFQb3NpdGlvbllDYWxjIDogbWluWVxuXG5cbiAgICBpZihjaGFyYVBvc2l0aW9uWUNhbGMgPiBtYXhZICYmIGNoYXJhUG9zaXRpb25ZQ2FsYyA+IHByZXZZIHx8IHByZXZZID09PSBtYXhZICApe1xuICAgICAgbWF4WSA9IE1hdGgubWF4KHByZXZZLCBjaGFyYVBvc2l0aW9uWUNhbGMpXG4gICAgICAvLyBjb25zb2xlLmxvZygnb2ggbXloIGdvZCBtYWtlIGl0IHN0b3AnLCBtYXhZLCBwcmV2WSlcbiAgICB9XG5cbiAgICBpZihjaGFyYVBvc2l0aW9uWUNhbGMgPD0gbWluWSApe1xuICAgICAgY2hhcmEucG9zaXRpb24ueSA9IG1pbllcbiAgICAgIGp1bXBSYW5nZS5pc0p1bXBpbmcgPSBmYWxzZVxuICAgICAganVtcFJhbmdlLmN1cnJlbnRQb3MgPSAwXG4gICAgfSBlbHNlIHtcbiAgICAgIGNoYXJhLnBvc2l0aW9uLnkgPSBjaGFyYVBvc2l0aW9uWUNhbGNcbiAgICB9XG5cbiAgICBwcmV2WSA9IGNoYXJhLnBvc2l0aW9uLnlcbiAgfVxuXG4gIGlmKCFtb3ZlbWVudC53YWxraW5nKXtcbiAgICBjaGFyWFBvc2l0aW9uLm5leHRYID0gY2hhcmEucG9zaXRpb24ueFxuXG4gIH0gZWxzZSB7XG4gICAgaWYoY2hhcmEucG9zaXRpb24ueCAgPCBjaGFyWFBvc2l0aW9uLm5leHRYKXtcbiAgICAgIGNoYXJhLnBvc2l0aW9uLnggKz0gLjFcbiAgICAgIGlmKGNoYXJhLnBvc2l0aW9uLnggPj0gNC44KXtcbiAgICAgICAgY2hhcmEucG9zaXRpb24ueCA9IDQuOFxuICAgICAgfVxuICAgIH1cblxuICAgIGlmKGNoYXJhLnBvc2l0aW9uLnggID4gY2hhclhQb3NpdGlvbi5uZXh0WCl7XG4gICAgICBjaGFyYS5wb3NpdGlvbi54IC09IC4xXG4gICAgICBpZihjaGFyYS5wb3NpdGlvbi54IDw9IC00Ljgpe1xuICAgICAgICBjaGFyYS5wb3NpdGlvbi54ID0gLTQuOFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cblxuICByZW5kZXJlci5yZW5kZXIoc2NlbmUsIGNhbWVyYSk7XG59O1xuXG5yZW5kZXIoKTtcbnZhciBkYVJlc2l6ZSA9IGZ1bmN0aW9uKCl7XG4gIGhhbmRsZVdpbmRvd1Jlc2l6ZShjYW1lcmEsIHJlbmRlcmVyKVxufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZGFSZXNpemUgKVxuIiwiLy8gaW1wb3J0IHtTQ1JFRU5fV0lEVEgsU0NSRUVOX0hFSUdIVCxjYW1lcmEscmVuZGVyZXJ9IGZyb20gJy4vYXBwLmpzJ1xuXG5cbnZhciBoYW5kbGVXaW5kb3dSZXNpemUgPSBmdW5jdGlvbihjYW0sIHJlbmRycil7XG4gIGxldCBjYW1lcmFfID0gY2FtO1xuICBsZXQgcmVuZGVyZXJfID0gcmVuZHJyXG5cbiAgbGV0IG5ld1dpZHRoID0gd2luZG93LmlubmVyV2lkdGgsXG4gICAgICBuZXdIZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cbiAgY2FtZXJhXy5hc3BlY3QgPSBuZXdXaWR0aCAvIG5ld0hlaWdodDtcbiAgY2FtZXJhXy51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gIHJlbmRlcmVyXy5zZXRTaXplKCBuZXdXaWR0aCwgbmV3SGVpZ2h0ICk7XG5cblxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBoYW5kbGVXaW5kb3dSZXNpemVcbn1cbiJdfQ==
